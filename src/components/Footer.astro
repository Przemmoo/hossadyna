---
// Stopka strony
import { getEntry } from 'astro:content';

const contactData = await getEntry('settings', 'contact');
const contact = contactData?.data || {
  phone: '+48 607 234 234',
  email: 'kontakt@hossadyna.pl',
  address: 'ul. Krakowska 6a\n32-020 Wieliczka'
};
---

<footer class="footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <div class="footer-logo">
          <img src="/images/logo.svg" alt="Magdalena Hossadyna - Psychoterapeuta" class="footer-logo-img" />
        </div>
        <p class="footer-description">
          Profesjonalna psychoterapia w&#160;nurcie integracyjnym (bio-psycho-społecznym) w&#160;Wieliczce. 
          Pomagam w&#160;radzeniu sobie z&#160;lękiem, depresją i&#160;innymi wyzwaniami życiowymi.
        </p>
        <div class="footer-social">
          
        </div>
      </div>

      <div class="footer-section">
        <h4>Szybkie linki</h4>
        <nav class="footer-nav">
          <a href="/#about">O mnie</a>
          <a href="/#services">Oferta</a>
          <a href="/#reviews">Opinie</a>
          <a href="/#articles">Artykuły</a>
          <a href="/#contact">Kontakt</a>
        </nav>
      </div>

      <div class="footer-section">
        <h4>Usługi</h4>
        <ul class="footer-services">
          <li>Terapia poznawczo-behawioralna</li>
          <li>Terapia online</li>
          <li>Terapia lęku i depresji</li>
          <li>Terapia stresu i wypalenia</li>
          <li>Budowanie samooceny</li>
        </ul>
      </div>

      <div class="footer-section">
        <h4>Kontakt</h4>
        <div class="footer-contact">
          <div class="contact-item-footer">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" stroke="currentColor" stroke-width="2" fill="none"/>
            </svg>
            <a href={`tel:${contact?.phone?.replace(/\s/g, '') || ''}`}>{contact?.phone || 'Brak numeru'}</a>
          </div>
          <div class="contact-item-footer">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z" stroke="currentColor" stroke-width="2"/>
              <polyline points="22,6 12,13 2,6" stroke="currentColor" stroke-width="2"/>
            </svg>
            <a href={`mailto:${contact.email}`}>{contact.email}</a>
          </div>
          <div class="contact-item-footer">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 10C21 17 12 23 12 23S3 17 3 10C3 5.02944 7.02944 1 12 1C16.9706 1 21 5.02944 21 10Z" stroke="currentColor" stroke-width="2"/>
              <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
            </svg>
            <span set:html={contact?.address?.replace(/\n/g, '<br>') || 'Brak adresu'}></span>
          </div>
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <div class="footer-bottom-content">
        <div class="footer-copyright">
          <p>&copy; 2025 Magdalena Hossadyna. Wszystkie prawa zastrzeżone.</p>
        </div>
        <div class="footer-legal">
          <a href="#" id="privacy-policy-link">Polityka Prywatności</a>
          <a href="#" id="cookie-settings-link">Ustawienia Cookies</a>
          <span class="separator">|</span>
          <span>Strona wykonana przez <a href="#" target="_blank">Przemo Kilan</a></span>
        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Privacy Policy Modal -->
<div id="privacy-policy-modal" class="modal">
  <div class="modal-content">
    <span class="modal-close">&times;</span>
    <div class="privacy-content">
      <h2>Polityka Prywatności</h2>
      <p><strong>Ostatnia aktualizacja:</strong> 24 lipca 2025</p>
      
      <h3>1. Administrator danych</h3>
      <p>Administratorem Twoich danych osobowych jest Magdalena Hossadyna, prowadząca działalność gospodarczą pod nazwą "Gabinet Psychoterapeutyczny Magdalena Hossadyna".</p>
      
      <h3>2. Dane kontaktowe</h3>
      <p>
        <strong>Adres:</strong> {contact?.address?.replace(/\n/g, ', ') || 'Brak adresu'}<br>
        <strong>E-mail:</strong> {contact?.email || 'Brak emaila'}<br>
        <strong>Telefon:</strong> {contact?.phone || 'Brak numeru'}
      </p>
      
      <h3>3. Cele przetwarzania danych</h3>
      <p>Twoje dane osobowe przetwarzam w następujących celach:</p>
      <ul>
        <li>Świadczenie usług psychoterapeutycznych (art. 6 ust. 1 lit. b RODO)</li>
        <li>Prowadzenie dokumentacji medycznej (art. 6 ust. 1 lit. c RODO)</li>
        <li>Komunikacja z pacjentami (art. 6 ust. 1 lit. f RODO)</li>
        <li>Marketing własnych usług - za zgodą (art. 6 ust. 1 lit. a RODO)</li>
      </ul>
      
      <h3>4. Prawa pacjenta</h3>
      <p>Masz prawo do:</p>
      <ul>
        <li>Dostępu do swoich danych</li>
        <li>Sprostowania danych</li>
        <li>Usunięcia danych (z zastrzeżeniami wynikającymi z przepisów prawa)</li>
        <li>Ograniczenia przetwarzania</li>
        <li>Przenoszenia danych</li>
        <li>Wniesienia sprzeciwu</li>
        <li>Cofnięcia zgody w dowolnym momencie</li>
      </ul>
      
      <h3>5. Pliki cookies</h3>
      <p>Strona wykorzystuje pliki cookies w celu:</p>
      <ul>
        <li>Zapewnienia prawidłowego funkcjonowania strony</li>
        <li>Dostosowania treści do preferencji użytkownika</li>
        <li>Prowadzenia analiz ruchu na stronie</li>
        <li>Wyświetlania reklam (za zgodą)</li>
      </ul>
      
      <h3>6. Zewnętrzne usługi</h3>
      <p>Strona korzysta z następujących usług zewnętrznych:</p>
      <ul>
        <li><strong>Znany Lekarz</strong> - widget rezerwacji wizyt</li>
        <li><strong>Google Analytics</strong> - analiza ruchu (za zgodą)</li>
        <li><strong>Google Maps</strong> - wyświetlanie mapy</li>
      </ul>
    </div>
  </div>
</div>

<style>
  .footer {
    background-color: var(--color-dark-graphite);
    color: var(--color-white);
    padding: 3rem 0 1rem;
  }

  .footer-content {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .footer-section h4 {
    color: var(--color-dusty-pink);
    margin-bottom: 1rem;
    font-size: 1.2rem;
  }

  .footer-logo-img {
    height: 40px;
    width: auto;
    margin-bottom: 1rem;
    filter: brightness(0) invert(1);
  }

  .footer-description {
    color: #CCCCCC;
    line-height: 1.6;
    margin-bottom: 1.5rem;
  }

  .footer-social {
    display: flex;
    gap: 1rem;
  }

  .social-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background-color: var(--color-dusty-pink);
    border-radius: 50%;
    color: var(--color-white);
    transition: background-color 0.3s ease;
  }

  .social-link:hover {
    background-color: var(--color-sage-green);
  }

  .footer-nav {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .footer-nav a {
    color: #CCCCCC;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .footer-nav a:hover {
    color: var(--color-dusty-pink);
  }

  .footer-services {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .footer-services li {
    color: #CCCCCC;
    padding: 0.25rem 0;
    font-size: 0.95rem;
  }

  .footer-contact {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .contact-item-footer {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #CCCCCC;
  }

  .contact-item-footer svg {
    color: var(--color-dusty-pink);
    flex-shrink: 0;
  }

  .contact-item-footer a {
    color: #CCCCCC;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .contact-item-footer a:hover {
    color: var(--color-dusty-pink);
  }

  .footer-bottom {
    border-top: 1px solid #555;
    padding-top: 2rem;
  }

  .footer-bottom-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .footer-copyright p {
    color: #CCCCCC;
    font-size: 0.9rem;
    margin: 0;
  }

  .footer-legal {
    display: flex;
    align-items: center;
    gap: 1rem;
    font-size: 0.9rem;
  }

  .footer-legal a {
    color: #CCCCCC;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .footer-legal a:hover {
    color: var(--color-dusty-pink);
  }

  .separator {
    color: #666;
  }

  /* Modal Styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 10000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
  }

  .modal-content {
    background-color: var(--color-white);
    margin: 2% auto;
    padding: 2rem;
    border-radius: 15px;
    width: 90%;
    max-width: 800px;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  }


  .modal-close {
    color: var(--color-dark-graphite);
    font-size: 2rem;
    font-weight: bold;
    cursor: pointer;
    position: absolute;
    top: 0.1rem;
    right: 0.1rem;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.3s ease;
  }

  .modal-close:hover,
  .modal-close:focus {
    background-color: var(--color-off-white);
    color: var(--color-dusty-pink);
    text-decoration: none;
  }

  /* Privacy Policy Modal */
  .privacy-content {
    max-height: 70vh;
    overflow-y: auto;
    padding-top: 1rem;
    margin-top: 0.5rem;
    padding-right: 2rem;
    margin-right: -1.1rem;
  }

  .privacy-content h2 {
    color: var(--color-dusty-pink);
    margin-bottom: 1rem;
    margin-top: 0;
    padding-right: 3rem;
  }

  .privacy-content h3 {
    color: var(--color-dark-graphite);
    margin: 2rem 0 1rem 0;
    font-size: 1.2rem;
  }

  .privacy-content ul {
    margin: 1rem 0;
    padding-left: 1.5rem;
  }

  .privacy-content li {
    margin: 0.5rem 0;
  }

  /* Mobile Styles */
  @media (max-width: 768px) {
    .footer {
      padding: 2rem 0 1rem;
      font-size: 0.8rem;
    }

    .footer-content {
      grid-template-columns: 1fr;
      gap: 0.5rem;
      align-items: center;
      flex-direction: column;
      text-align: center;
    font-size: 0.8rem;
    }
    .footer-services li {
    font-size: 0.8rem;
    }

    .footer-bottom-content {
      flex-direction: column;
      text-align: center;
      gap: 1rem;
    }
    .footer-copyright p {
      flex-direction: column;
      font-size: 0.7rem;
      gap: 0.1rem;
    }
 

    .footer-legal {
      flex-direction: column;
      gap: 0.1rem;
      font-size: 0.7rem;
    }

    .separator {
      display: none;
    }

    .contact-item-footer {
      flex-direction: column;
      text-align: center;
      gap: 0.25rem;
    }

    .modal-content {
      width: 95%;
      margin: 5% auto;
      padding: 1.5rem;
      max-height: 85vh;
    }

    .modal-close {
      top: 0.5rem;
      right: 1.5rem;
      width: 35px;
      height: 35px;
      font-size: 1.8rem;
    }

    .privacy-content {
      padding-right: 1rem;
      margin-right: 1rem;
    }

    .privacy-content h2 {
      padding-right: 2rem;
      font-size: 1.0rem;
    }
  }
</style>

<script>
  // Privacy policy modal functionality
  document.addEventListener('DOMContentLoaded', () => {
    const privacyModal = document.getElementById('privacy-policy-modal');
    const privacyLink = document.getElementById('privacy-policy-link');
    const cookieSettingsLink = document.getElementById('cookie-settings-link');
    const closeBtn = privacyModal?.querySelector('.modal-close');

    // Open privacy policy modal
    privacyLink?.addEventListener('click', (e) => {
      e.preventDefault();
      if (privacyModal) {
        privacyModal.style.display = 'block';
        document.body.style.overflow = 'hidden';
      }
    });

    // Cookie settings (will integrate with cookie banner)
    cookieSettingsLink?.addEventListener('click', (e) => {
      e.preventDefault();
      
      // Try to open cookie settings modal directly
      const cookieSettingsModal = document.getElementById('cookie-settings-modal');
      
      if (cookieSettingsModal) {
        cookieSettingsModal.style.display = 'block';
        document.body.style.overflow = 'hidden';
        
        // Load current preferences if they exist
        const cookieConsent = localStorage.getItem('cookieConsent');
        if (cookieConsent) {
          const preferences = JSON.parse(cookieConsent);
          const analyticsCheckbox = document.getElementById('analytics-cookies') as HTMLInputElement;
          const marketingCheckbox = document.getElementById('marketing-cookies') as HTMLInputElement;
          const externalCheckbox = document.getElementById('external-cookies') as HTMLInputElement;
          
          if (analyticsCheckbox) analyticsCheckbox.checked = preferences.analytics;
          if (marketingCheckbox) marketingCheckbox.checked = preferences.marketing;
          if (externalCheckbox) externalCheckbox.checked = preferences.external;
        }
      } else if (typeof window.openCookieSettings === 'function') {
        // Fallback to the global function
        window.openCookieSettings();
      } else {
        // Last fallback - show cookie banner
        const cookieBanner = document.getElementById('cookie-banner') as HTMLElement;
        if (cookieBanner) {
          cookieBanner.style.display = 'block';
          cookieBanner.classList.add('show');
        }
      }
    });

    // Close modal
    closeBtn?.addEventListener('click', () => {
      if (privacyModal) {
        privacyModal.style.display = 'none';
        document.body.style.overflow = 'auto';
      }
    });

    // Close modal when clicking outside
    window.addEventListener('click', (e) => {
      if (e.target === privacyModal && privacyModal) {
        privacyModal.style.display = 'none';
        document.body.style.overflow = 'auto';
      }
    });

    // Handle privacy policy links from forms
    document.addEventListener('click', (e) => {
      const target = e.target as HTMLElement;
      if (target?.getAttribute('href') === '#privacy-policy') {
        e.preventDefault();
        if (privacyModal) {
          privacyModal.style.display = 'block';
          document.body.style.overflow = 'hidden';
        }
      }
    });
  });
</script>
